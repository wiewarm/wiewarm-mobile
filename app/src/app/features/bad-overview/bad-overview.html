<div class="item-viewport">
  <div class="bad-overview-header">
    <h1>Aktuelle Temperaturen</h1>

    @if (favorites().length) {
    @for (fav of favorites(); track fav.beckenid) {
    <article app-favorite-item [favorite]="fav"></article>
    } }
    <div class="search-controls">
      <div class="search">
        <span class="search-emoji" aria-hidden="true">&#128269;</span>
        <input
          #searchField
          type="text"
          [(ngModel)]="searchInput"
          (blur)="onSearchBlur()"
          placeholder="Suche…"
          aria-label="Badi suchen"
        />
      </div>
      <app-filter-sort-controls
        [sortOption]="this.listPreferences.sortField()"
        [sortDirection]="this.listPreferences.sortDirection()"
        [filterOption]="this.listPreferences.filterField()"
        (setSort)="this.listPreferences.setSort($event.field, $event.direction)"
        (setFilter)="this.listPreferences.setFilter($event)"
      ></app-filter-sort-controls>
    </div>
  </div>

  <app-loading-error
    [state]="badResource.isLoading() ? 'loading':badResource.error() ? 'error' : 'idle' "
  ></app-loading-error>

  <div
    class="accordion"
    [class.has-content]="filteredItems().length > 0"
    cdkAccordion
  >
    @for (item of filteredItems(); track item.beckenid; let i = $index) {
    <app-bad-item [item]="item" [index]="i"></app-bad-item>
    } @if ( !badResource.isLoading() && !badResource.error() &&
    filteredItems().length === 0 ) {
    <div class="status" role="status">
      <span aria-hidden="true">😕</span>
      <p>Keine Resultate gefunden.</p>
    </div>
    }
  </div>
</div>
